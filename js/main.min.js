jQuery(document).ready(function(a){function b(){var a=Backbone.history.fragment,b=a.split("/"),c=b[0].charAt(0).toUpperCase()+b[0].substr(1);c=c.replace(/-/g," "),r.text(c+" at "+q)}function c(){a("html, body").animate({scrollTop:0},123)}function d(b){a("html,body").animate({scrollTop:b})}function e(){a(".info-nav a").each(function(){a(this).removeClass("active")}),a(".info-nav").find('a[href="/menu/yummycakes"]').addClass("active")}function f(b){b===!1?a(".flexslider").flexslider({controlNav:!0,useCSS:!0,prevText:"",nextText:"",pauseOnAction:!0,pauseOnHover:!0,touch:!0,keyboard:!0,slideshowSpeed:5678,animationSpeed:234,initDelay:234}):b===!0&&(a("#thumbnails").flexslider({controlNav:!1,useCSS:!0,keyboard:!1,animationLoop:!1,slideshow:!1,itemWidth:140,itemMargin:10,asNavFor:"#carousel"}),a("#carousel").flexslider({controlNav:!1,animationLoop:!1,slideshow:!1,useCSS:!0,keyboard:!1,touch:!0,animationSpeed:100,sync:"#thumbnails"}),a("#thumbnails li").removeAttr("style")),a("a.flex-next, a.flex-prev").attr("data-bypass","true"),a(document).keydown(function(b){return 37===b.keyCode?(a("#carousel").flexslider("prev"),!1):39===b.keyCode?(a("#carousel").flexslider("next"),!1):void 0})}function g(){Modernizr.touch&&a(".menu").dropit()}function h(){a("nav a").each(function(){a(this).removeClass("active")});var b=Backbone.history.fragment;a("#logo-and-nav").find('a[href="/'+b+'"]').addClass("active");var c=b.split("/");c.length>1&&a("#logo-and-nav").find('a[href="/'+b+'"]').parentsUntil("ul.menu").children("a").addClass("active")}function i(){function b(){s.hasClass("success")||a("#content").load(o+p+"templates/loading.php")}s.removeClass("success"),setTimeout(b,500)}function j(){var b=a("img.unveil");b.unveil(0,function(){a(this).load(function(){this.style.opacity=1})}),a(window).resize(_.debounce(function(){b.unveil()},500))}function k(){var b=null;return a.ajax({async:!1,type:"GET",url:GinAjax.ajaxurl,data:{action:"get_site_title",WhiskeyNonce:GinAjax.WhiskeyNonce},dataType:"text",success:function(a){b=a},error:function(){}}),b}function l(){var b=null;return a.ajax({async:!1,type:"GET",url:GinAjax.ajaxurl,data:{action:"get_tagline",WhiskeyNonce:GinAjax.WhiskeyNonce},dataType:"text",success:function(a){b=a},error:function(){}}),b}function m(){var b=a(".map-canvas"),c=b.attr("data-latitude"),d=b.attr("data-longitude"),e=new google.maps.LatLng(c,d),f={center:e,zoom:14,scrollwheel:!1,mapTypeId:google.maps.MapTypeId.ROADMAP},g=new google.maps.Map(document.getElementById("home-map"),f),h=[];a(".map-marker").each(function(){h.push([a(this).attr("data-title"),a(this).attr("data-latitude"),a(this).attr("data-longitude"),a(this).attr("data-address"),a(this).attr("data-url"),a(this).find(".map-room-features").html()])});var i;n(g,h),i=new google.maps.InfoWindow({content:"Loading..."})}function n(a,b){for(var c=0;c<b.length;c++){var d=b[c],e=new google.maps.LatLng(d[1],d[2]),f=new google.maps.Marker({position:e,map:a,title:d[0],html:'<div class="map-info-window"><p class="map-info-window-title">'+d[0]+"</p><p>"+d[3]+'</br><a href="'+d[4]+'">Read More</a></p><span class="single-room-info">'+d[5]+"</span></div>"});google.maps.event.addListener(f,"click",function(){infoWindow.setContent(this.html),infoWindow.open(a,this)})}}var o=(a("script[src]").next().attr("src").split("?")[0].split("/").slice(0,-4).join("/")+"/","/"),p="wp-content/themes/beer/",q=k(),l=l(),r=a("title"),s=a("body"),t=a("#site"),u=a("#content");s.removeClass("hidden");var v=Backbone.Router.extend({routes:{"":"homeAction","news/:page":"newsPostAction",news:"loopNewsAction","blog/categories/:page":"blogCategoryAction","blog/:page":"blogArticleAction","*page":"defaultAction"},initialize:function(){this.bind("route",this._pageView),this.route(/\d{4}(?:\/\d{2})*/,"blogArticleAction")},_pageView:function(){var a=Backbone.history.fragment;ga("send","pageview",{page:"/"+a})},defaultAction:function(a){a&&(this.loadPageData(a,"page"),b())},homeAction:function(){this.loadPageData("home","home"),r.text(q+" is "+l)},loadPageData:function(d,e){function k(a,b){s.addClass("success"),u.html(b),f(),g(),j(),h(),c()}var l=Backbone.history.fragment;b(),h();var m="cache-"+d;t.data(m)?k(d,t.data(m)):a.ajax({type:"GET",url:GinAjax.ajaxurl,data:{action:"get_"+e,fragment:l,WhiskeyNonce:GinAjax.WhiskeyNonce},beforeSend:function(){i()},dataType:"text",success:function(a){k(d,a),t.data(m,a),j()},error:function(){u.load(o+"templates/404.php")}})}});new v,Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.history.start({pushState:!0,root:o}),a("#site").on("click","a[href]:not([data-bypass])",function(b){var c={prop:a(this).prop("href"),attr:a(this).attr("href")},d=location.protocol+"//"+location.host,e=location.pathname;t.data("currentPath",e);var f=t.data("currentPath").split("/")[1];t.data("historyPath",f);var g=Backbone.history.fragment.split("/")[1];t.data("clickedPath",g),c.prop.slice(0,d.length)!==d||b.metaKey||(b.preventDefault(),Backbone.history.navigate(c.attr,!0))}),a(document).on("click","#site a.null",function(a){a.preventDefault()}),a(document).on("click","#site a.some-slug",function(a){a.preventDefault(),c()}),a(document).on("click","#site a.scroll",function(b){b.preventDefault();var c=a(this).attr("href").split("/"),e=a("section.menu-"+c[2]).offset().top;d(e),a(".info-nav a").each(function(){a(this).removeClass("active")}),a(".info-nav").find('a[href="/menu/'+c[2]+'"]').addClass("active")});var w=_.debounce(function(){var b=a(window).scrollTop();0==b&&e()},50);window.addEventListener("scroll",w,!1);var x=a("#beer-contact-form"),y=a("#beer-contact-form input");x.submit(function(b){b.preventDefault();var c=!0;if(y.each(function(){a(this).hasClass("error")&&(c=!1)}),c===!0){var d=a(this).serialize();sidebarForm(d)}}),a(window).resize(_.debounce(function(){m()},345))});